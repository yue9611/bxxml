window.__require=function t(e,o,n){function i(s,a){if(!o[s]){if(!e[s]){var h=s.split("/");if(h=h[h.length-1],!e[h]){var p="function"==typeof __require&&__require;if(!a&&p)return p(h,!0);if(r)return r(h,!0);throw new Error("Cannot find module '"+s+"'")}s=h}var c=o[s]={exports:{}};e[s][0].call(c.exports,function(t){return i(e[s][1][t]||t)},c,c.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({ChooseLevelUI:[function(t,e,o){"use strict";cc._RF.push(e,"f021amoMRJIF4MR+vKuWQ0/","ChooseLevelUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/Action3dManager"),a=t("../../Script/Common/GlobalPool"),h=t("../../Script/Common/PlayerData"),p=t("../../Script/Common/yyComponent"),c=t("../../Script/GameSpecial/GameEventType"),u=t("../../Script/GameSpecial/GlobalEnum"),l=t("./LvBox"),d=cc._decorator,y=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._uiType=u.GlobalEnum.UI.chooseLevel,e.levelRecords={},e.nowLv=1,e.maxLv=20,e.indexNum=[-4,1,6],e.lastNode=null,e.nextNode=null,e.boxsS=[],e.boxsScr=[],e.lvBox=null,e.touchMask=null,e.touchMaskCount=!1,e.scenes=[],e}return i(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return this._uiType},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.touchMaskCount=!1,this.initBoxsS(),this.updateTMC(),this.onEvents()},e.prototype.reset=function(){},e.prototype.setData=function(t){t&&t.nowlv?this.nowLv=t.nowlv:this.nowLv=h.default.getData("gameData.curLevel"),t&&t.maxLv?this.maxLv=t.maxLv:this.maxLv=20,this.levelRecords=h.default.getData("gameData.levelRecords"),this.setIndexNum()},e.prototype.show=function(t){this.node.active=!0,t?this.setData(t):this.setData()},e.prototype.onEvents=function(){this.on(c.EventType.ChooseEvent.levelClose,this.levelClose,this),this.on(c.EventType.ChooseEvent.levelChoose,this.levelChoose,this)},e.prototype.offEvents=function(){this.on(c.EventType.ChooseEvent.levelClose,this.levelClose,this),this.on(c.EventType.ChooseEvent.levelChoose,this.levelChoose,this)},e.prototype.levelClose=function(){this.emit(c.EventType.UIEvent.showTip,"\u5173\u5361\u672a\u5f00\u653e"),console.log("\u5173\u5361\u672a\u5f00\u653e")},e.prototype.levelChoose=function(t){t>0&&t<=this.maxLv?(console.log("\u5173\u5361\u5b58\u5728\uff0c\u5c06\u8fdb\u5165\u5173\u5361"),this.emit(c.EventType.DirectorEvent.enterLevel,t),this.emit(c.EventType.UIEvent.exit,u.GlobalEnum.UI.chooseLevel)):console.log("\u5173\u5361\u6682\u65f6\u672a\u51c6\u5907\u597d\uff0c\u8fdb\u5165\u5173\u5361\u5931\u8d25")},e.prototype.setIndexNum=function(){var t=5*Math.floor((this.nowLv-1)/5)+1;this.indexNum=[t-5,t,t+5],this.updateBoxs()},e.prototype.last=function(){this.onBtn(this.lastNode),this.indexNum[1]-this.indexNum[0]==5&&this.indexNum[0]>0?this.rightMove():(this.emit(c.EventType.UIEvent.showTip,"\u8fd9\u8fb9\u6ca1\u6709\u4e86"),console.log("\u65e0\u6548\u5173\u5361\u9875"))},e.prototype.next=function(){this.onBtn(this.nextNode),this.indexNum[2]-this.indexNum[1]==5&&this.indexNum[2]<=this.maxLv?this.leftMove():(this.emit(c.EventType.UIEvent.showTip,"\u8fd9\u8fb9\u6ca1\u6709\u4e86"),console.log("\u65e0\u6548\u5173\u5361\u9875"))},e.prototype.rightMove=function(){this.indexNum=[this.indexNum[0]-5,this.indexNum[0],this.indexNum[1]],this.boxsS=[this.boxsS[2],this.boxsS[0],this.boxsS[1]],this.boxsScr=[this.boxsScr[2],this.boxsScr[0],this.boxsScr[1]],this.updateBoxs()},e.prototype.leftMove=function(){this.indexNum=[this.indexNum[1],this.indexNum[2],this.indexNum[2]+5],this.boxsS=[this.boxsS[1],this.boxsS[2],this.boxsS[0]],this.boxsScr=[this.boxsScr[1],this.boxsScr[2],this.boxsScr[0]],this.updateBoxs()},e.prototype.initBoxsS=function(){a.default.createPool(this.lvBox.name,this.lvBox,this.lvBox.name);for(var t=0;t<this.boxsS.length;t++)for(var e=0;e<5;e++){var o=a.default.get("LvBox");this.boxsScr[t]||this.boxsScr.push([]),this.boxsS[t].addChild(o);var n=o.getComponent(l.default);this.boxsScr[t].push(n)}},e.prototype.updateBoxs=function(){this.moveBoxS();var t=Math.floor((this.indexNum[1]-1)/5);this.setScene(t);for(var e=0;e<this.indexNum.length;e++)this.indexNum[e]>0&&this.indexNum[e]<=this.maxLv?this.updataBox(e):console.log("\u975e\u6cd5\u5173\u5361")},e.prototype.updateTMC=function(){this.touchMaskCount?this.touchMask.active=!0:this.touchMask.active=!1},e.prototype.moveBoxS=function(){for(var t=s.default.getMng(s.ActionMngType.UI),e=0;e<this.boxsS.length;e++){var o=1500*e-1500,n=this.boxsS[e].getPosition();if(Math.abs(n.x-o)>2e3)this.boxsS[e].setPosition(cc.v2(o,n.y));else{var i=s.default.moveTo(1,o,n.y),r=s.default.callFun(this.boxMoved,this),a=s.default.sequence(i,r);t.runAction(this.boxsS[e],a),this.touchMaskCount=!0}}this.updateTMC()},e.prototype.boxMoved=function(){this.touchMaskCount=!1,this.updateTMC()},e.prototype.updataBox=function(t){for(var e=this.indexNum[t],o=0;o<this.boxsScr[t].length;o++){var n=e+o;n>this.maxLv&&(n=0);var i=3,r=0;n<this.nowLv?(i=1,r=this.getStarNum(n)):n==this.nowLv?i=2:n>this.nowLv&&(i=3),this.boxsScr[t][o].setData({lv:n,openState:i,starNum:r})}},e.prototype.getStarNum=function(t){return this.levelRecords[t]?this.levelRecords[t]:0},e.prototype.onBtn=function(t){var e=.97;t.setScale(e,e),e=1.03;var o=s.default.scaleTo(.5,e,e,e);e=.97;var n=s.default.scaleTo(.5,e,e,e),i=s.default.sequence(o,n);s.default.getMng(s.ActionMngType.UI).runAction(t,i)},e.prototype.stopBtn=function(t){s.default.getMng(s.ActionMngType.UI).stopAllActions(t)},e.prototype.setScene=function(t){for(var e=0;e<this.scenes.length;e++)this.scenes[e].active=e==t},r([f(cc.Node)],e.prototype,"lastNode",void 0),r([f(cc.Node)],e.prototype,"nextNode",void 0),r([f([cc.Node])],e.prototype,"boxsS",void 0),r([f(cc.Prefab)],e.prototype,"lvBox",void 0),r([f(cc.Node)],e.prototype,"touchMask",void 0),r([f([cc.Node])],e.prototype,"scenes",void 0),r([y],e)}(p.default);o.default=m,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0,"./LvBox":"LvBox"}],ConfigSettingUI:[function(t,e,o){"use strict";cc._RF.push(e,"5219a61WZBHrLPY3aPlPMyY","ConfigSettingUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),a=t("../../Script/GameSpecial/GameConfig"),h=t("../../Script/GameSpecial/GameEventType"),p=t("../../Script/GameSpecial/GlobalEnum"),c=cc._decorator,u=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.togBGM=null,e.togEffect=null,e.togVibrate=null,e}return i(e,t),e.prototype.initConfig=function(){var t=a.default.audioConfig;this.togBGM.isChecked=t.bgm,this.togEffect.isChecked=t.effect;var e=a.default.driveConfig;this.togVibrate.isChecked=e.vibrate},e.prototype.init=function(){this.initComponents(),this.initConfig()},e.prototype.show=function(){this.node.active||(this.node.active=!0,this.emit(h.EventType.DirectorEvent.pauseLevel),this.initConfig())},e.prototype.hide=function(){this.node.active&&(this.node.active=!1,this.emit(h.EventType.DirectorEvent.resumeLevel))},e.prototype.saveConfig=function(){var t={bgm:this.togBGM.isChecked,effect:this.togEffect.isChecked};a.default.audioConfig=t;var e={vibrate:this.togVibrate.isChecked};a.default.driveConfig=e},e.prototype.onBtnClose=function(){this.saveConfig(),this.emit(h.EventType.DirectorEvent.resumeLevel),this.emit(h.EventType.UIEvent.exit,p.GlobalEnum.UI.configSetting)},e.prototype.onCloseBGM=function(){this.togBGM.isChecked?this.emit(h.EventType.AudioEvent.playBGM,p.GlobalEnum.AudioClip.BGMLobby):this.emit(h.EventType.AudioEvent.stopBGM)},r([l(cc.Toggle)],e.prototype,"togBGM",void 0),r([l(cc.Toggle)],e.prototype,"togEffect",void 0),r([l(cc.Toggle)],e.prototype,"togVibrate",void 0),r([u],e)}(s.default);o.default=d,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameConfig":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],GetPropUI:[function(t,e,o){"use strict";cc._RF.push(e,"a0c27yb2NNPA4/pE9857oFC","GetPropUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/PlayerData"),a=t("../../Script/Common/yyComponent"),h=t("../../Script/GameSpecial/AdConfig"),p=t("../../Script/GameSpecial/GameEventType"),c=t("../../Script/GameSpecial/GlobalEnum"),u=cc._decorator,l=u.ccclass,d=u.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._uiType=c.GlobalEnum.UI.getProp,e.bombNumUp=null,e.bombLVUp=null,e.speedUp=null,e.showSpr=null,e.type=null,e}return i(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return this._uiType},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.node.active=!0,this.randomProp()},e.prototype.reuse=function(){},e.prototype.unuse=function(){},e.prototype.show=function(){this.node.active=!0,this.emit(p.EventType.UIEvent.enter,c.GlobalEnum.UI.playerAssetBar),this.randomProp(),this.showBanner()},e.prototype.hide=function(){this.node.active=!1,this.emit(p.EventType.UIEvent.exit,c.GlobalEnum.UI.playerAssetBar)},e.prototype.setData=function(){},e.prototype.randomProp=function(){var t=Math.floor(3*Math.random());switch(3==t&&(t=2),t){case 0:this.type="BNum",this.showSpr.spriteFrame=this.bombNumUp;break;case 1:this.type="BLV",this.showSpr.spriteFrame=this.bombLVUp;break;case 2:this.type="SLV",this.showSpr.spriteFrame=this.speedUp}},e.prototype.onBtnBuy=function(){this.emit(p.EventType.AudioEvent.playClickBtn),s.default.getData("gameData.asset.gold")<200?this.tipGoldUnenough():(this.subGold(200),this.addPorp())},e.prototype.subGold=function(t){this.emit(p.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.asset.gold",value:t,mode:"-",save:!1,emit:!0})},e.prototype.tipGoldUnenough=function(){this.emit(p.EventType.UIEvent.showTip,"\u91d1\u5e01\u4e0d\u8db3")},e.prototype.onBtnVideo=function(){this.emit(p.EventType.AudioEvent.playClickBtn),this.emit(p.EventType.SDKEvent.showVideo,{success:this.videoSuccess.bind(this),quit:this.VideoQuit.bind(this)})},e.prototype.videoSuccess=function(){this.addPorp()},e.prototype.VideoQuit=function(){this.emit(p.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u9053\u5177~~")},e.prototype.addPorp=function(){this.emit(p.EventType.GetPropEvent.GetProp,{type:this.type,value:1}),this.emit(p.EventType.UIEvent.showTip,"\u9053\u5177\u83b7\u53d6\u6210\u529f"),this._startGame()},e.prototype.onBtnStartGame=function(){this.emit(p.EventType.AudioEvent.playClickBtn),this._startGame()},e.prototype._startGame=function(){this.emit(p.EventType.GetPropEvent.startGame),this.emit(p.EventType.UIEvent.exit,c.GlobalEnum.UI.getProp),this.hide()},e.prototype.showBanner=function(){this.emit(p.EventType.SDKEvent.showBanner,{id:h.AdConfig.bannerID.lobby,style:{horizontal:"middle",width:750}})},r([d(cc.SpriteFrame)],e.prototype,"bombNumUp",void 0),r([d(cc.SpriteFrame)],e.prototype,"bombLVUp",void 0),r([d(cc.SpriteFrame)],e.prototype,"speedUp",void 0),r([d(cc.Sprite)],e.prototype,"showSpr",void 0),r([l],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/AdConfig":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],GoldDialogUI:[function(t,e,o){"use strict";cc._RF.push(e,"2328a6f3zNP3rgYp7MZewax","GoldDialogUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),a=t("../../Script/GameSpecial/GameEventType"),h=t("../../Script/GameSpecial/GlobalEnum"),p=cc._decorator,c=p.ccclass,u=p.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goldLabel=null,e}return i(e,t),e.prototype.init=function(){this.initComponents()},e.prototype.show=function(){this.node.active||(this.node.active=!0)},e.prototype.hide=function(){this.node.active&&(this.node.active=!1)},e.prototype.onBtnClose=function(){},e.prototype.onBtnVideo=function(){this.emit(a.EventType.AudioEvent.playClickBtn),this.emit(a.EventType.SDKEvent.showVideo,{success:this.getGold.bind(this),quit:this.playVideoFail.bind(this)})},e.prototype.getGold=function(){this.addGold(500,this.onBtnClose.bind(this))},e.prototype.playVideoFail=function(){this.emit(a.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u91d1\u5e01\u54e6~~")},e.prototype.addGold=function(t,e){var o=this;this.emit(a.EventType.AudioEvent.playEffect,h.GlobalEnum.AudioClip.gold);var n=this.goldLabel.convertToWorldSpaceAR(cc.v2()),i=cc.find("Canvas");n.x-=.5*i.width,n.y-=.5*i.height,this.emit(a.EventType.UIEvent.playGoldAnim,{startPos:n,cb:function(){o.emit(a.EventType.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t,mode:"+"}),e&&e()},gold:t})},r([u(cc.Node)],e.prototype,"goldLabel",void 0),r([c],e)}(s.default);o.default=l,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],LvBox:[function(t,e,o){"use strict";cc._RF.push(e,"f64e0wcvChKOb8O9LY6OK9p","LvBox");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),a=t("../../Script/GameSpecial/GameEventType"),h=cc._decorator,p=h.ccclass,c=h.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lvLab=null,e.lv=0,e.openState=3,e.openNode=null,e.starNum=0,e.starNodes=[],e}return i(e,t),e.prototype.setLv=function(t){t||(t=0),this.lv=t,this.lvLab.string=this.lv.toString()},e.prototype.setState=function(t){switch(t||(t=3),this.openState=t,this.openState){case 1:this.openNode.active=!0;break;case 2:case 3:this.openNode.active=!1}},e.prototype.setStar=function(t){this.starNum=t;for(var e=0;e<this.starNodes.length;e++)e<this.starNum?this.starNodes[e].active=!0:this.starNodes[e].active=!1},e.prototype.init=function(t){this.node.active=!1,t?this.setData(t):this.setData({lv:0,openState:3,starNum:0})},e.prototype.reuse=function(t){this.node.active=!1,t?this.setData(t):this.setData({lv:0,openState:3,starNum:0})},e.prototype.unuse=function(){this.node.active=!1,this.lvLab.string="0"},e.prototype.setData=function(t){this.setLv(t.lv),this.setState(t.openState),this.setStar(t.starNum),0==this.lv?this.node.active=!1:this.node.active=!0},e.prototype.onClick=function(){switch(this.openState){case 1:console.log("\u8fdb\u5165\u5df2\u901a\u5173\u5173\u5361,\u6ce8\u610f\u9053\u5177\u53ef\u80fd\u65e0\u6cd5\u83b7\u5f97"),this.emit(a.EventType.ChooseEvent.levelChoose,this.lv);break;case 2:console.log("\u8fdb\u5165\u5f53\u524d\u5173\u5361"),this.emit(a.EventType.ChooseEvent.levelChoose,this.lv);break;case 3:console.log("\u5173\u5361\u672a\u89e3\u9501\uff0c\u8fdb\u5165\u5931\u8d25\uff0c\u8bf7\u4f9d\u6b21\u901a\u5173"),this.emit(a.EventType.ChooseEvent.levelClose);break;default:console.log("\u53d1\u751f\u672a\u77e5\u9519\u8bef\uff0c\u5173\u5361\u9009\u62e9\u5931\u8d25\uff0c\u8bf7\u9009\u62e9\u5176\u4ed6\u5173\u5361"),this.emit(a.EventType.ChooseEvent.levelClose)}},r([c(cc.Label)],e.prototype,"lvLab",void 0),r([c(cc.Node)],e.prototype,"openNode",void 0),r([c([cc.Node])],e.prototype,"starNodes",void 0),r([p],e)}(s.default);o.default=u,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0}],ShopItem:[function(t,e,o){"use strict";cc._RF.push(e,"5a631MrW1ZFcYMlXrLofj5W","ShopItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s,a=t("../../Script/Common/GameData"),h=t("../../Script/Common/PlayerData"),p=t("../../Script/Common/yyComponent"),c=t("../../Script/GameSpecial/GameEventType"),u=t("../../Script/GameSpecial/GlobalEnum");(function(t){t[t.using=0]="using",t[t.owned=1]="owned",t[t.needBuy=2]="needBuy",t[t.needTry=3]="needTry",t[t.trying=4]="trying"})(s||(s={}));var l=cc._decorator,d=l.ccclass,y=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=s.needBuy,e.id=0,e.role=null,e.gun=null,e.ATK=null,e.SPD=null,e.DEF=null,e.costNode=null,e.goldNum=null,e.value=null,e.usingNode=null,e}return i(e,t),e.prototype.init=function(){this.onEvents()},e.prototype.reset=function(){},e.prototype.setData=function(t){this.id=t,this.setRoleSkin(this.id);var e=a.default.getData(u.GlobalEnum.GameDataType.playerSkin,this.id);this.setSkill(e),this.setGold(e),this.setState()},e.prototype.onEvents=function(){this.node.on("touchend",this.touchEnd,this),this.on(c.EventType.ShopEvent.usingItem,this.usingItem,this)},e.prototype.offEvents=function(){this.node.off("touchend",this.touchEnd,this),this.off(c.EventType.ShopEvent.usingItem,this.usingItem,this)},e.prototype.touchEnd=function(){this.state==s.owned?this.emit(c.EventType.ShopEvent.usingItem,this.id):this.state==s.needBuy&&this.btnBuy()},e.prototype.usingItem=function(t){t==this.id?(this.state=s.using,this.usingNode.active=!0):this.state==s.using&&(this.state=s.owned,this.usingNode.active=!1)},e.prototype.btnBuy=function(){h.default.getData("gameData.asset.gold")<this.value?this.tipGoldUnenough():(this.emit(c.EventType.ShopEvent.chooseItemBuy,this.id,this.value),this.setState(),this.emit(c.EventType.ShopEvent.usingItem,this.id))},e.prototype.tipGoldUnenough=function(){this.emit(c.EventType.UIEvent.showTip,"\u91d1\u5e01\u4e0d\u8db3")},e.prototype.setRoleSkin=function(t){var e;e=t&&0!=t?t<10?"ski0"+t.toString():"ski"+t.toString():"ski01",this.role.setSkin(e)},e.prototype.setSkill=function(t){t.ATK&&(this.ATK.string=t.ATK),t.SPD&&(this.SPD.string=t.SPD),t.DEF&&(this.DEF.string=t.DEF)},e.prototype.setGold=function(t){if(t&&t.cost){var e=t.cost;"default"==e.type?this.costNode.active=!1:"gold"==e.type&&(this.costNode.active=!0,this.goldNum.string=e.value,this.value=e.value)}},e.prototype.setState=function(){var t=h.default.getData("gameData.PlayerSkin");this.id==t.cur?(this.state=s.using,this.usingNode.active=!0,this.costNode.active=!1):t.owned.indexOf(this.id)>=0?(this.state=s.owned,this.usingNode.active=!1,this.costNode.active=!1):(this.state=s.needBuy,this.usingNode.active=!1,this.costNode.active=!0)},r([y(sp.Skeleton)],e.prototype,"role",void 0),r([y(cc.Node)],e.prototype,"gun",void 0),r([y(cc.Label)],e.prototype,"ATK",void 0),r([y(cc.Label)],e.prototype,"SPD",void 0),r([y(cc.Label)],e.prototype,"DEF",void 0),r([y(cc.Node)],e.prototype,"costNode",void 0),r([y(cc.Label)],e.prototype,"goldNum",void 0),r([y(cc.Node)],e.prototype,"usingNode",void 0),r([d],e)}(p.default);o.default=f,cc._RF.pop()},{"../../Script/Common/GameData":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],ShopUI:[function(t,e,o){"use strict";cc._RF.push(e,"f1146XD9dZL0oi7dzvFICfT","ShopUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/yyComponent"),a=t("../../Script/GameSpecial/GlobalEnum"),h=t("../../Script/GameSpecial/GameEventType"),p=t("../../Script/Common/PlayerData"),c=t("./ShopItem"),u=cc._decorator,l=u.ccclass,d=u.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._uiType=a.GlobalEnum.UI.shop,e.itemLayer=null,e.itemPrefab=null,e.items=[],e.role=null,e.gun=null,e}return i(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return this._uiType},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.initItem(),this.initComponents(),this.onEvents()},e.prototype.onEvents=function(){this.on(h.EventType.ShopEvent.chooseItemBuy,this.onBtnBuy,this),this.on(h.EventType.ShopEvent.usingItem,this.onBtnUsing,this)},e.prototype.reset=function(){this.resetItem()},e.prototype.show=function(){this.node.active=!0,this.emit(h.EventType.UIEvent.enter,a.GlobalEnum.UI.playerAssetBar),this.updateShowRole()},e.prototype.hide=function(){this.node.active=!1,this.emit(h.EventType.UIEvent.exit,a.GlobalEnum.UI.playerAssetBar)},e.prototype.setData=function(){},e.prototype.initItem=function(){this.curItemId=p.default.getData("gameData.PlayerSkin.cur"),this.items=[],this.itemLayer.removeAllChildren();for(var t=0;t<12;++t){var e=cc.instantiate(this.itemPrefab),o=e.getComponent(c.default);this.itemLayer.addChild(e),this.items.push(o),o.init()}this.setItem()},e.prototype.setItem=function(){for(var t=0;t<this.items.length;t++)this.items[t].setData(t+1)},e.prototype.resetItem=function(){},e.prototype.onBtnExit=function(){this.emit(h.EventType.AudioEvent.playClickBtn),this.emit(h.EventType.UIEvent.exit,this.uiType)},e.prototype.onBtnBuy=function(t,e){this.curItemId=t,this.subGold(e),this.unlockSkin(a.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.setCurSkin(a.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.updateShowRole()},e.prototype.subGold=function(t){this.emit(h.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.asset.gold",value:t,mode:"-",save:!1,emit:!0})},e.prototype.unlockSkin=function(t,e){this.emit(h.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".owned",value:parseInt(e),mode:"push",save:!1,emit:!1})},e.prototype.setCurSkin=function(t,e){this.emit(h.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".cur",value:parseInt(e),mode:"=",save:!0,emit:!0})},e.prototype.tipGoldUnenough=function(){this.emit(h.EventType.UIEvent.showTip,"\u91d1\u5e01\u4e0d\u8db3")},e.prototype.onBtnVideo=function(t){this.curItemId=t.itemId,this.emit(h.EventType.AudioEvent.playClickBtn),this.emit(h.EventType.SDKEvent.showVideo,{success:this.tryByVideo.bind(this),quit:this.tryByVideoQuit.bind(this)})},e.prototype.tryByVideo=function(){this.unlockSkin(a.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.setCurSkin(a.GlobalEnum.GoodsType.playerSkin,this.curItemId)},e.prototype.tryByVideoQuit=function(){this.emit(h.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u8bd5\u7528\u65b0\u76ae\u80a4\u54e6~~")},e.prototype.onBtnUsing=function(t){this.curItemId=t,this.emit(h.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerSkin.cur",value:t,mode:"=",save:!0,emit:!0}),this.updateShowRole()},e.prototype.updateShowRole=function(){var t;t=this.curItemId&&0!=this.curItemId?this.curItemId<10?"ski0"+this.curItemId.toString():"ski"+this.curItemId.toString():"ski01",this.role.setSkin(t)},e.prototype.onBtnStartgame=function(){this.onBtnExit(),this.emit(h.EventType.DirectorEvent.enterLevel)},r([d(cc.Node)],e.prototype,"itemLayer",void 0),r([d(cc.Prefab)],e.prototype,"itemPrefab",void 0),r([d(sp.Skeleton)],e.prototype,"role",void 0),r([d(cc.Node)],e.prototype,"gun",void 0),r([l],e)}(s.default);o.default=y,cc._RF.pop()},{"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0,"./ShopItem":"ShopItem"}],TouchBannerUI1:[function(t,e,o){"use strict";cc._RF.push(e,"6746aKOT7lHLZEiPuMTWQ+O","TouchBannerUI1");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/Action3dManager"),a=t("../../Script/Common/GameFlow"),h=t("../../Script/Common/PlayerData"),p=t("../../Script/Common/yyComponent"),c=t("../../Script/GameSpecial/GameEventType"),u=t("../../Script/GameSpecial/GlobalEnum"),l=cc._decorator,d=l.ccclass,y=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=null,e.barTotalLength=0,e.progress=0,e.box=null,e.animaPlaying=!1,e.player=null,e.playPlayAnima=!1,e.directortion=null,e.mustTouchBanner=!1,e.targetProgress=.8,e.bannerShowing=!1,e.bannerShowCount=0,e.clickCount=0,e.targetClickCount=0,e.allType="123",e.freeTime=0,e.timerBanner3=null,e.finishAnima=!1,e.goldLabel=null,e}return i(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return u.GlobalEnum.UI.touchBanner1},enumerable:!1,configurable:!0}),e.prototype.init=function(t){if(this.initAnim(),this.initProgress(),void 0!==t){this.randomTouchCount(t);var e=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}},e.prototype.reset=function(){this.resetAnim(),this.resetProgress(),this.stopDirec()},e.prototype.show=function(t){if(console.log("touchbanner1\u5f00\u5173\u914d\u7f6e\uff1a",t),this.node.active=!0,this.reset(),this.showPlayer(),this.playDirec(),this.randomTouchCount(t),t){this.config=t.config;var e=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}else this.randomType("z")},e.prototype.hide=function(){this.off(c.EventType.SDKEvent.show,this.onShow,this),this.reset(),this.node.active=!1},e.prototype.initProgress=function(){this.barTotalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width,this.progress=0,this.updateBarWidth()},e.prototype.resetProgress=function(){this.progress=0,this.updateBarWidth()},e.prototype.updateBarWidth=function(){var t=this.barTotalLength*this.progress;t<1&&(t=1),this.bar.width=t},e.prototype.updateProgress=function(t){this.subProgress(.1*t)},e.prototype.subProgress=function(t){this.progress-=t,this.progress<0&&(this.progress=0),this.updateBarWidth()},e.prototype.addProgress=function(t){this.progress+=t,this.progress>1&&(this.progress=1),this.updateBarWidth(),this.progress>=1&&this.touchBannerFinish()},e.prototype.initAnim=function(){this.animaPlaying=!1,this.box.active=!0},e.prototype.resetAnim=function(){s.default.getMng(s.ActionMngType.UI).stopAllActions(this.box),this.box.active=!0,this.animaPlaying=!1},e.prototype.clickBox=function(){if(!this.animaPlaying){this.animaPlaying=!0;var t=s.default.moveBy(.1,10,0,0),e=s.default.moveBy(.1,-10,0,0),o=s.default.callFun(this.onBoxAnimFinish,this),n=s.default.sequence(t,e,o);s.default.getMng(s.ActionMngType.UI).runAction(this.box,n)}},e.prototype.onBoxAnimFinish=function(){this.animaPlaying=!1},e.prototype.showPlayer=function(){var t,e=h.default.getCurSkinId();t=e&&0!=e?e<10?"ski0"+e.toString():"ski"+e.toString():"ski01",this.player.setSkin(t)},e.prototype.playAnim=function(){this.playPlayAnima=!0;var t=s.default.moveBy(.05,20,0,0),e=s.default.callFun(this.nodeOver,this),o=s.default.moveBy(.05,-20,0,0),n=s.default.callFun(this.animaOver,this),i=s.default.sequence(t,e,o,n);s.default.getMng(s.ActionMngType.UI).runAction(this.player.node,i)},e.prototype.nodeOver=function(){this.clickBox(),this.emit(c.EventType.AudioEvent.playEffect,u.GlobalEnum.AudioClip.metal)},e.prototype.animaOver=function(){this.playPlayAnima=!1},e.prototype.playDirec=function(){var t=.8;this.directortion.setScale(t,t),t=1.2;var e=s.default.scaleTo(.5,t,t,t);t=.8;var o=s.default.scaleTo(.5,t,t,t),n=s.default.sequence(e,o),i=s.default.repeatForever(n);s.default.getMng(s.ActionMngType.UI).runAction(this.directortion,i)},e.prototype.stopDirec=function(){s.default.getMng(s.ActionMngType.UI).stopAllActions(this.directortion)},e.prototype.initTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.resetTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.randomTouchCount=function(t){this.mustTouchBanner=a.default.getGlobalConfig(u.GlobalEnum.GameFlowGlobalConfig.mustTouchBanner);var e=2,o=6;if(void 0!==t&&void 0!==t.config){var n=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerClickCount].split("-");e=parseInt(n[0]),o=parseInt(n[1])}this.targetProgress=.1*(e+Math.round(Math.random()*(o-e))),this.bannerShowing=!1,this.bannerShowCount=0,this.freeTime=0,this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1},e.prototype.randomType=function(t){t&&"z"!=t&&"0"!=t||(t=this.allType);var e=Math.floor(Math.random()*(t.length-1e-5));this.zadanType=t[e]},e.prototype.onBtnShot=function(){this.playPlayAnima||this.finishAnima||(this.playAnim(),this.addProgress(.2),this["zadan"+this.zadanType]&&this["zadan"+this.zadanType]())},e.prototype.zadan1=function(){!this.bannerShowing&&this.progress>=this.targetProgress&&(this.mustTouchBanner&&window.wx?this.once(c.EventType.SDKEvent.showBannerSuccess,this.waitTouchBanner,this):this.once(c.EventType.SDKEvent.showBannerSuccess,this.autoHideBanner,this),this._showBanner())},e.prototype.autoHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3)},e.prototype.waitTouchBanner=function(){var t=this;this.once(c.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner()},2e3)},e.prototype.onShow=function(){this._hideBanner(),null!==this.timerBanner3&&(clearTimeout(this.timerBanner3),this.timerBanner3=null),this.touchBannerFinish()},e.prototype.zadan2=function(){var t=this;!this.bannerShowing&&this.progress>=this.targetProgress&&(this._showBanner(),this.mustTouchBanner&&window.wx?this.waitTouchBanner():setTimeout(function(){t._hideBanner(),t.bannerShowCount>=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerRepeatCount]&&t.touchBannerFinish()},2e3))},e.prototype.zadan3=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress)switch(this.bannerShowCount){case 0:this.showBanner1();break;case 1:this.showBanenr2()}},e.prototype.showBanner=function(){this._showBanner()},e.prototype.showBanner1=function(){this.once(c.EventType.SDKEvent.show,this.onShow,this),this.once(c.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.targetProgress=.01},e.prototype.showBanenr2=function(){this.once(c.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.timerBanner3=setTimeout(this.showBanner3.bind(this),3e3)},e.prototype.showBanner3=function(){var t=this;this.node.activeInHierarchy&&(this.showBanner(),setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3))},e.prototype.zadan4=function(){this.freeTime=0,this.clickCount+=1,this.clickCount==this.targetClickCount&&(this.once(c.EventType.SDKEvent.show,this.onShow,this),this.once(c.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this._showBanner()),5==this.clickCount&&(this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1)},e.prototype._showBanner=function(){this.emit(c.EventType.SDKEvent.showBanner,{bannerID:"touchBannerUI",style:{horizontal:"right"}}),this.bannerShowing=!0,this.bannerShowCount+=1},e.prototype.delayHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner()},1e3)},e.prototype._hideBanner=function(){this.bannerShowing=!1,this.emit(c.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!1})},e.prototype._removeBanner=function(){this.bannerShowing=!1,this.emit(c.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.refreshBanner=function(){this.bannerShowing=!1,this.emit(c.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.touchBannerFinish=function(){this.refreshBanner(),this.finishAnima||(this.finishAnima=!0,s.default.getMng(s.ActionMngType.UI).stopAllActions(this.box),s.default.getMng(s.ActionMngType.UI).stopAllActions(this.player.node),this.boxFly())},e.prototype.boxFly=function(){var t=s.default.moveBy(.5,2e3,2e3,0),e=s.default.rotateBy2d(.5,360),o=s.default.spawn(t,e),n=s.default.callFun(this.playerMove,this),i=s.default.sequence(o,n);s.default.getMng(s.ActionMngType.UI).runAction(this.box,i)},e.prototype.playerMove=function(){var t=this;this.emit(c.EventType.AudioEvent.playEffect,u.GlobalEnum.AudioClip.voiceWin),this.player.setAnimation(0,"diao",!1),this.player.timeScale=.5,setTimeout(function(){t.player.setAnimation(0,"pao",!0),t.player.timeScale=1;var e=s.default.moveBy(3,2e3,0,0),o=s.default.callFun(t.animaFinish,t),n=s.default.sequence(e,o);s.default.getMng(s.ActionMngType.UI).runAction(t.player.node,n)},1e3)},e.prototype.animaFinish=function(){this.box.setPosition(cc.v2(-250,-90)),this.box.angle=0,this.player.setAnimation(0,"daiji",!0),this.player.node.setPosition(cc.v2(-260,-270)),this.finishAnima=!1,this.exit()},e.prototype.exit=function(){this.emit(c.EventType.UIEvent.exit,u.GlobalEnum.UI.playerAssetBar),this.emit(c.EventType.UIEvent.exit,this.uiType),this.emit(c.EventType.UIEvent.touchBannerFinish)},e.prototype.addGold=function(t,e){var o=this;this.emit(c.EventType.AudioEvent.playEffect,u.GlobalEnum.AudioClip.gold);var n=this.goldLabel.convertToWorldSpaceAR(cc.v2()),i=cc.find("Canvas");n.x-=.5*i.width,n.y-=.5*i.height,this.emit(c.EventType.UIEvent.playGoldAnim,{startPos:n,cb:function(){o.emit(c.EventType.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t,mode:"+"}),e&&e()},gold:t})},e.prototype.update=function(t){this.updateProgress(t)},r([y(cc.Node)],e.prototype,"bar",void 0),r([y(cc.Node)],e.prototype,"box",void 0),r([y(sp.Skeleton)],e.prototype,"player",void 0),r([y(cc.Node)],e.prototype,"directortion",void 0),r([y(cc.Node)],e.prototype,"goldLabel",void 0),r([d],e)}(p.default);o.default=f,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameFlow":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],TouchBannerUI2:[function(t,e,o){"use strict";cc._RF.push(e,"f5746AM1zBI0aYZBV+jlElv","TouchBannerUI2");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/Action3dManager"),a=t("../../Script/Common/GameFlow"),h=t("../../Script/Common/PlayerData"),p=t("../../Script/Common/yyComponent"),c=t("../../Script/GameSpecial/GameEventType"),u=t("../../Script/GameSpecial/GlobalEnum"),l=cc._decorator,d=l.ccclass,y=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=null,e.barTotalLength=0,e.progress=0,e.box=null,e.animaPlaying=!1,e.player=null,e.mustTouchBanner=!1,e.targetProgress=.8,e.bannerShowing=!1,e.bannerShowCount=0,e.clickCount=0,e.targetClickCount=0,e.allType="123",e.freeTime=0,e.timerBanner3=null,e.goldLabel=null,e}return i(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return u.GlobalEnum.UI.touchBanner2},enumerable:!1,configurable:!0}),e.prototype.init=function(t){if(this.initAnim(),this.initProgress(),void 0!==t){this.randomTouchCount(t);var e=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}},e.prototype.reset=function(){this.resetAnim(),this.resetProgress()},e.prototype.show=function(t){if(console.log("touchbanner2\u5f00\u5173\u914d\u7f6e\uff1a",t),this.node.active=!0,this.reset(),this.showPlayer(),this.randomTouchCount(t),t){this.config=t.config;var e=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}else this.randomType("z")},e.prototype.hide=function(){this.off(c.EventType.SDKEvent.show,this.onShow,this),this.reset(),this.node.active=!1},e.prototype.initProgress=function(){this.barTotalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width,this.progress=0,this.updateBarWidth()},e.prototype.resetProgress=function(){this.bar.active=!0,this.progress=0,this.updateBarWidth()},e.prototype.updateBarWidth=function(){var t=this.barTotalLength*(1-this.progress);t<1&&(t=1),this.bar.width=t},e.prototype.updateProgress=function(t){this.subProgress(.1*t)},e.prototype.subProgress=function(t){this.progress-=t,this.progress<0&&(this.progress=0),this.updateBarWidth()},e.prototype.addProgress=function(t){this.progress+=t,this.progress>1&&(this.progress=1),this.updateBarWidth(),this.progress>=1&&this.touchBannerFinish()},e.prototype.initAnim=function(){this.animaPlaying=!1},e.prototype.resetAnim=function(){this.animaPlaying=!1},e.prototype.playAnim=function(){if(!this.animaPlaying){this.animaPlaying=!0,this.player.setAnimation(1,"yao",!1);var t=s.default.rotateTo2d(.2,-20),e=s.default.callFun(this.clickBox,this),o=s.default.rotateTo2d(.2,0),n=s.default.callFun(this.onBoxAnimFinish,this),i=s.default.sequence(t,e,o,n);s.default.getMng(s.ActionMngType.UI).runAction(this.player.node,i)}},e.prototype.clickBox=function(){this.emit(c.EventType.AudioEvent.playEffect,u.GlobalEnum.AudioClip.box);var t=s.default.moveBy(.025,10,0,0),e=s.default.moveBy(.025,-10,0,0),o=s.default.sequence(t,e);s.default.getMng(s.ActionMngType.UI).runAction(this.box,o)},e.prototype.onBoxAnimFinish=function(){this.animaPlaying=!1},e.prototype.showPlayer=function(){var t,e=h.default.getCurSkinId();t=e&&0!=e?e<10?"ski0"+e.toString():"ski"+e.toString():"ski01",this.player.setSkin(t)},e.prototype.initTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.resetTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.randomTouchCount=function(t){this.mustTouchBanner=a.default.getGlobalConfig(u.GlobalEnum.GameFlowGlobalConfig.mustTouchBanner);var e=2,o=6;if(void 0!==t&&void 0!==t.config){var n=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerClickCount].split("-");e=parseInt(n[0]),o=parseInt(n[1])}this.targetProgress=.1*(e+Math.round(Math.random()*(o-e))),this.bannerShowing=!1,this.bannerShowCount=0,this.freeTime=0,this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1},e.prototype.randomType=function(t){t&&"z"!=t&&"0"!=t||(t=this.allType);var e=Math.floor(Math.random()*(t.length-1e-5));this.zadanType=t[e]},e.prototype.onBtnShot=function(){this.animaPlaying||(this.playAnim(),this.addProgress(.2),this["zadan"+this.zadanType]&&this["zadan"+this.zadanType]())},e.prototype.zadan1=function(){!this.bannerShowing&&this.progress>=this.targetProgress&&(this.mustTouchBanner&&window.wx?this.once(c.EventType.SDKEvent.showBannerSuccess,this.waitTouchBanner,this):this.once(c.EventType.SDKEvent.showBannerSuccess,this.autoHideBanner,this),this._showBanner())},e.prototype.autoHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3)},e.prototype.waitTouchBanner=function(){var t=this;this.once(c.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner()},2e3)},e.prototype.onShow=function(){this._hideBanner(),null!==this.timerBanner3&&(clearTimeout(this.timerBanner3),this.timerBanner3=null),this.touchBannerFinish()},e.prototype.zadan2=function(){var t=this;!this.bannerShowing&&this.progress>=this.targetProgress&&(this._showBanner(),this.mustTouchBanner&&window.wx?this.waitTouchBanner():setTimeout(function(){t._hideBanner(),t.bannerShowCount>=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerRepeatCount]&&t.touchBannerFinish()},2e3))},e.prototype.zadan3=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress)switch(this.bannerShowCount){case 0:this.showBanner1();break;case 1:this.showBanenr2()}},e.prototype.showBanner=function(){this._showBanner()},e.prototype.showBanner1=function(){this.once(c.EventType.SDKEvent.show,this.onShow,this),this.once(c.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.targetProgress=.01},e.prototype.showBanenr2=function(){this.once(c.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.timerBanner3=setTimeout(this.showBanner3.bind(this),3e3)},e.prototype.showBanner3=function(){var t=this;this.node.activeInHierarchy&&(this.showBanner(),setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3))},e.prototype.zadan4=function(){this.freeTime=0,this.clickCount+=1,this.clickCount==this.targetClickCount&&(this.once(c.EventType.SDKEvent.show,this.onShow,this),this.once(c.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this._showBanner()),5==this.clickCount&&(this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1)},e.prototype._showBanner=function(){this.emit(c.EventType.SDKEvent.showBanner,{bannerID:"touchBannerUI",style:{horizontal:"right"}}),this.bannerShowing=!0,this.bannerShowCount+=1},e.prototype.delayHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner()},1e3)},e.prototype._hideBanner=function(){this.bannerShowing=!1,this.emit(c.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!1})},e.prototype._removeBanner=function(){this.bannerShowing=!1,this.emit(c.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.refreshBanner=function(){this.bannerShowing=!1,this.emit(c.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.touchBannerFinish=function(){this.refreshBanner(),this.emit(c.EventType.UIEvent.enter,u.GlobalEnum.UI.playerAssetBar),this.addGold(200,this.exit.bind(this)),this.bar.active=!1},e.prototype.exit=function(){this.emit(c.EventType.UIEvent.exit,u.GlobalEnum.UI.playerAssetBar),this.emit(c.EventType.UIEvent.exit,this.uiType),this.emit(c.EventType.UIEvent.touchBannerFinish)},e.prototype.addGold=function(t,e){var o=this;this.emit(c.EventType.AudioEvent.playEffect,u.GlobalEnum.AudioClip.gold);var n=this.goldLabel.convertToWorldSpaceAR(cc.v2()),i=cc.find("Canvas");n.x-=.5*i.width,n.y-=.5*i.height,this.emit(c.EventType.UIEvent.playGoldAnim,{startPos:n,cb:function(){o.emit(c.EventType.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t,mode:"+"}),e&&e()},gold:t})},e.prototype.update=function(t){this.updateProgress(t)},r([y(cc.Node)],e.prototype,"bar",void 0),r([y(cc.Node)],e.prototype,"box",void 0),r([y(sp.Skeleton)],e.prototype,"player",void 0),r([y(cc.Node)],e.prototype,"goldLabel",void 0),r([d],e)}(p.default);o.default=f,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameFlow":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],TouchBannerUI3:[function(t,e,o){"use strict";cc._RF.push(e,"3126bqyaMNNU40wsVfXuhmD","TouchBannerUI3");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/Action3dManager"),a=t("../../Script/Common/GameFlow"),h=t("../../Script/Common/GlobalPool"),p=t("../../Script/Common/PlayerData"),c=t("../../Script/Common/yyComponent"),u=t("../../Script/GameSpecial/GameEventType"),l=t("../../Script/GameSpecial/GlobalEnum"),d=cc._decorator,y=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=null,e.barTotalLength=0,e.progress=0,e.box=null,e.animaPlaying=!1,e.player=null,e.mustTouchBanner=!1,e.targetProgress=.8,e.bannerShowing=!1,e.bannerShowCount=0,e.clickCount=0,e.targetClickCount=0,e.allType="123",e.freeTime=0,e.timerBanner3=null,e.goldLabel=null,e}return i(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return l.GlobalEnum.UI.touchBanner3},enumerable:!1,configurable:!0}),e.prototype.init=function(t){if(this.initAnim(),this.initProgress(),void 0!==t){this.randomTouchCount(t);var e=t.config[l.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}},e.prototype.reset=function(){this.resetAnim(),this.resetProgress()},e.prototype.show=function(t){if(console.log("touchbanner2\u5f00\u5173\u914d\u7f6e\uff1a",t),this.node.active=!0,this.reset(),this.showPlayer(),this.randomTouchCount(t),t){this.config=t.config;var e=t.config[l.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}else this.randomType("z")},e.prototype.hide=function(){this.off(u.EventType.SDKEvent.show,this.onShow,this),this.reset(),this.node.active=!1},e.prototype.initProgress=function(){this.barTotalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width,this.progress=0,this.updateBarWidth()},e.prototype.resetProgress=function(){this.bar.active=!0,this.progress=0,this.updateBarWidth()},e.prototype.updateBarWidth=function(){var t=this.barTotalLength*(1-this.progress);t<1&&(t=1),this.bar.width=t},e.prototype.updateProgress=function(t){this.subProgress(.1*t)},e.prototype.subProgress=function(t){this.progress-=t,this.progress<0&&(this.progress=0),this.updateBarWidth()},e.prototype.addProgress=function(t){this.progress+=t,this.progress>1&&(this.progress=1),this.updateBarWidth(),this.progress>=1&&this.touchBannerFinish()},e.prototype.initAnim=function(){this.animaPlaying=!1},e.prototype.resetAnim=function(){this.animaPlaying=!1},e.prototype.playAnim=function(){if(!this.animaPlaying){this.animaPlaying=!0,this.player.setAnimation(1,"yao",!1);var t=s.default.moveBy(.1,100,0,0),e=s.default.callFun(this.clickBox,this),o=s.default.moveBy(.1,-100,0,0),n=s.default.callFun(this.onBoxAnimFinish,this),i=s.default.sequence(t,e,o,n);s.default.getMng(s.ActionMngType.UI).runAction(this.player.node,i)}},e.prototype.clickBox=function(){this.emit(u.EventType.AudioEvent.playEffect,l.GlobalEnum.AudioClip.box);var t=s.default.moveBy(.025,10,0,0),e=s.default.moveBy(.025,-10,0,0),o=s.default.sequence(t,e);s.default.getMng(s.ActionMngType.UI).runAction(this.box,o)},e.prototype.onBoxAnimFinish=function(){this.animaPlaying=!1},e.prototype.showPlayer=function(){var t,e=p.default.getCurSkinId();t=e&&0!=e?e<10?"ski0"+e.toString():"ski"+e.toString():"ski01",this.player.setSkin(t)},e.prototype.initTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.resetTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.randomTouchCount=function(t){this.mustTouchBanner=a.default.getGlobalConfig(l.GlobalEnum.GameFlowGlobalConfig.mustTouchBanner);var e=2,o=6;if(void 0!==t&&void 0!==t.config){var n=t.config[l.GlobalEnum.RecommendFlowConfig.touchBannerClickCount].split("-");e=parseInt(n[0]),o=parseInt(n[1])}this.targetProgress=.1*(e+Math.round(Math.random()*(o-e))),this.bannerShowing=!1,this.bannerShowCount=0,this.freeTime=0,this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1},e.prototype.randomType=function(t){t&&"z"!=t&&"0"!=t||(t=this.allType);var e=Math.floor(Math.random()*(t.length-1e-5));this.zadanType=t[e]},e.prototype.onBtnShot=function(){this.animaPlaying||(this.playAnim(),this.addProgress(.2),this["zadan"+this.zadanType]&&this["zadan"+this.zadanType]())},e.prototype.zadan1=function(){!this.bannerShowing&&this.progress>=this.targetProgress&&(this.mustTouchBanner&&window.wx?this.once(u.EventType.SDKEvent.showBannerSuccess,this.waitTouchBanner,this):this.once(u.EventType.SDKEvent.showBannerSuccess,this.autoHideBanner,this),this._showBanner())},e.prototype.autoHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3)},e.prototype.waitTouchBanner=function(){var t=this;this.once(u.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner()},2e3)},e.prototype.onShow=function(){this._hideBanner(),null!==this.timerBanner3&&(clearTimeout(this.timerBanner3),this.timerBanner3=null),this.touchBannerFinish()},e.prototype.zadan2=function(){var t=this;!this.bannerShowing&&this.progress>=this.targetProgress&&(this._showBanner(),this.mustTouchBanner&&window.wx?this.waitTouchBanner():setTimeout(function(){t._hideBanner(),t.bannerShowCount>=t.config[l.GlobalEnum.RecommendFlowConfig.touchBannerRepeatCount]&&t.touchBannerFinish()},2e3))},e.prototype.zadan3=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress)switch(this.bannerShowCount){case 0:this.showBanner1();break;case 1:this.showBanenr2()}},e.prototype.showBanner=function(){this._showBanner()},e.prototype.showBanner1=function(){this.once(u.EventType.SDKEvent.show,this.onShow,this),this.once(u.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.targetProgress=.01},e.prototype.showBanenr2=function(){this.once(u.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.timerBanner3=setTimeout(this.showBanner3.bind(this),3e3)},e.prototype.showBanner3=function(){var t=this;this.node.activeInHierarchy&&(this.showBanner(),setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3))},e.prototype.zadan4=function(){this.freeTime=0,this.clickCount+=1,this.clickCount==this.targetClickCount&&(this.once(u.EventType.SDKEvent.show,this.onShow,this),this.once(u.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this._showBanner()),5==this.clickCount&&(this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1)},e.prototype._showBanner=function(){this.emit(u.EventType.SDKEvent.showBanner,{bannerID:"touchBannerUI",style:{horizontal:"right"}}),this.bannerShowing=!0,this.bannerShowCount+=1},e.prototype.delayHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner()},1e3)},e.prototype._hideBanner=function(){this.bannerShowing=!1,this.emit(u.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!1})},e.prototype._removeBanner=function(){this.bannerShowing=!1,this.emit(u.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.refreshBanner=function(){this.bannerShowing=!1,this.emit(u.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.touchBannerFinish=function(){this.refreshBanner(),this.emit(u.EventType.UIEvent.enter,l.GlobalEnum.UI.playerAssetBar),this.addGold(200,this.exit.bind(this)),this.bar.active=!1,this.bomb()},e.prototype.bomb=function(){var t=h.default.get("Burst");t&&(this.box.addChild(t),this.emit(u.EventType.SDKEvent.vibrateShort),t.setPosition(cc.v2(0,0)),t.setScale(2,2),t.group="UI",t.getComponent("Burst").setData(),this.emit(u.EventType.AudioEvent.playEffect,l.GlobalEnum.AudioClip.noCarBomb))},e.prototype.exit=function(){this.emit(u.EventType.UIEvent.exit,l.GlobalEnum.UI.playerAssetBar),this.emit(u.EventType.UIEvent.exit,this.uiType),this.emit(u.EventType.UIEvent.touchBannerFinish)},e.prototype.addGold=function(t,e){var o=this;this.emit(u.EventType.AudioEvent.playEffect,l.GlobalEnum.AudioClip.gold);var n=this.goldLabel.convertToWorldSpaceAR(cc.v2()),i=cc.find("Canvas");n.x-=.5*i.width,n.y-=.5*i.height,this.emit(u.EventType.UIEvent.playGoldAnim,{startPos:n,cb:function(){o.emit(u.EventType.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t,mode:"+"}),e&&e()},gold:t})},e.prototype.update=function(t){this.updateProgress(t)},r([f(cc.Node)],e.prototype,"bar",void 0),r([f(cc.Node)],e.prototype,"box",void 0),r([f(sp.Skeleton)],e.prototype,"player",void 0),r([f(cc.Node)],e.prototype,"goldLabel",void 0),r([y],e)}(c.default);o.default=m,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameFlow":void 0,"../../Script/Common/GlobalPool":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],TouchBannerUI4:[function(t,e,o){"use strict";cc._RF.push(e,"659dcDqSppPC47vK8c/g2fB","TouchBannerUI4");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Script/Common/Action3dManager"),a=t("../../Script/Common/GameFlow"),h=t("../../Script/Common/yyComponent"),p=t("../../Script/GameSpecial/GameEventType"),c=t("../../Script/GameSpecial/GlobalEnum"),u=cc._decorator,l=u.ccclass,d=u.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bar=null,e.barTotalLength=0,e.progress=0,e.box=null,e.animaPlaying=!1,e.player=null,e.mustTouchBanner=!1,e.targetProgress=.8,e.bannerShowing=!1,e.bannerShowCount=0,e.clickCount=0,e.targetClickCount=0,e.allType="123",e.freeTime=0,e.timerBanner3=null,e.goldLabel=null,e}return i(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return c.GlobalEnum.UI.touchBanner4},enumerable:!1,configurable:!0}),e.prototype.init=function(t){if(this.initAnim(),this.initProgress(),void 0!==t){this.randomTouchCount(t);var e=t.config[c.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}},e.prototype.reset=function(){this.resetAnim(),this.resetProgress()},e.prototype.show=function(t){if(console.log("touchbanner4\u5f00\u5173\u914d\u7f6e\uff1a",t),this.node.active=!0,this.reset(),this.randomTouchCount(t),t){this.config=t.config;var e=t.config[c.GlobalEnum.RecommendFlowConfig.touchBannerRandomMode];void 0!==e&&"number"==typeof e&&(e=e.toString()),this.randomType(e)}else this.randomType("z")},e.prototype.hide=function(){this.off(p.EventType.SDKEvent.show,this.onShow,this),this.reset(),this.node.active=!1},e.prototype.initProgress=function(){this.barTotalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width,this.progress=0,this.updateBarWidth()},e.prototype.resetProgress=function(){this.bar.active=!0,this.progress=0,this.updateBarWidth()},e.prototype.updateBarWidth=function(){var t=this.barTotalLength*(1-this.progress);t<1&&(t=1),this.bar.width=t},e.prototype.updateProgress=function(t){this.subProgress(.1*t)},e.prototype.subProgress=function(t){this.progress-=t,this.progress<0&&(this.progress=0),this.updateBarWidth()},e.prototype.addProgress=function(t){this.progress+=t,this.progress>1&&(this.progress=1),this.updateBarWidth(),this.progress>=1&&this.touchBannerFinish()},e.prototype.initAnim=function(){this.animaPlaying=!1},e.prototype.resetAnim=function(){this.animaPlaying=!1},e.prototype.playAnim=function(){if(!this.animaPlaying){this.animaPlaying=!0;var t=s.default.moveTo(.1,0,30),e=s.default.callFun(this.clickBox,this),o=s.default.moveTo(.1,0,-60),n=s.default.callFun(this.onBoxAnimFinish,this),i=s.default.sequence(t,e,o,n);s.default.getMng(s.ActionMngType.UI).runAction(this.player,i)}},e.prototype.clickBox=function(){this.emit(p.EventType.AudioEvent.playEffect,c.GlobalEnum.AudioClip.box);var t=s.default.moveBy(.025,10,0,0),e=s.default.moveBy(.025,-10,0,0),o=s.default.sequence(t,e);s.default.getMng(s.ActionMngType.UI).runAction(this.box,o)},e.prototype.onBoxAnimFinish=function(){this.animaPlaying=!1},e.prototype.initTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.resetTouchCount=function(){this.bannerShowing=!1,this.bannerShowCount=0,this.clickCount=0,this.freeTime=0},e.prototype.randomTouchCount=function(t){this.mustTouchBanner=a.default.getGlobalConfig(c.GlobalEnum.GameFlowGlobalConfig.mustTouchBanner);var e=2,o=6;if(void 0!==t&&void 0!==t.config){var n=t.config[c.GlobalEnum.RecommendFlowConfig.touchBannerClickCount].split("-");e=parseInt(n[0]),o=parseInt(n[1])}this.targetProgress=.1*(e+Math.round(Math.random()*(o-e))),this.bannerShowing=!1,this.bannerShowCount=0,this.freeTime=0,this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1},e.prototype.randomType=function(t){t&&"z"!=t&&"0"!=t||(t=this.allType);var e=Math.floor(Math.random()*(t.length-1e-5));this.zadanType=t[e]},e.prototype.onBtnShot=function(){this.animaPlaying||(this.playAnim(),this.addProgress(.2),this["zadan"+this.zadanType]&&this["zadan"+this.zadanType]())},e.prototype.zadan1=function(){!this.bannerShowing&&this.progress>=this.targetProgress&&(this.mustTouchBanner&&window.wx?this.once(p.EventType.SDKEvent.showBannerSuccess,this.waitTouchBanner,this):this.once(p.EventType.SDKEvent.showBannerSuccess,this.autoHideBanner,this),this._showBanner())},e.prototype.autoHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3)},e.prototype.waitTouchBanner=function(){var t=this;this.once(p.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t._hideBanner()},2e3)},e.prototype.onShow=function(){this._hideBanner(),null!==this.timerBanner3&&(clearTimeout(this.timerBanner3),this.timerBanner3=null),this.touchBannerFinish()},e.prototype.zadan2=function(){var t=this;!this.bannerShowing&&this.progress>=this.targetProgress&&(this._showBanner(),this.mustTouchBanner&&window.wx?this.waitTouchBanner():setTimeout(function(){t._hideBanner(),t.bannerShowCount>=t.config[c.GlobalEnum.RecommendFlowConfig.touchBannerRepeatCount]&&t.touchBannerFinish()},2e3))},e.prototype.zadan3=function(){if(!this.bannerShowing&&this.progress>=this.targetProgress)switch(this.bannerShowCount){case 0:this.showBanner1();break;case 1:this.showBanenr2()}},e.prototype.showBanner=function(){this._showBanner()},e.prototype.showBanner1=function(){this.once(p.EventType.SDKEvent.show,this.onShow,this),this.once(p.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.targetProgress=.01},e.prototype.showBanenr2=function(){this.once(p.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this.showBanner(),this.timerBanner3=setTimeout(this.showBanner3.bind(this),3e3)},e.prototype.showBanner3=function(){var t=this;this.node.activeInHierarchy&&(this.showBanner(),setTimeout(function(){t._hideBanner(),t.touchBannerFinish()},2e3))},e.prototype.zadan4=function(){this.freeTime=0,this.clickCount+=1,this.clickCount==this.targetClickCount&&(this.once(p.EventType.SDKEvent.show,this.onShow,this),this.once(p.EventType.SDKEvent.showBannerSuccess,this.delayHideBanner,this),this._showBanner()),5==this.clickCount&&(this.clickCount=0,this.targetClickCount=Math.floor(4.9999*Math.random())+1)},e.prototype._showBanner=function(){this.emit(p.EventType.SDKEvent.showBanner,{bannerID:"touchBannerUI",style:{horizontal:"middle"}}),this.bannerShowing=!0,this.bannerShowCount+=1},e.prototype.delayHideBanner=function(){var t=this;setTimeout(function(){t._hideBanner()},1e3)},e.prototype._hideBanner=function(){this.bannerShowing=!1,this.emit(p.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!1})},e.prototype._removeBanner=function(){this.bannerShowing=!1,this.emit(p.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.refreshBanner=function(){this.bannerShowing=!1,this.emit(p.EventType.SDKEvent.hideBanner,{bannerID:"touchBannerUI",refresh:!0})},e.prototype.touchBannerFinish=function(){this.refreshBanner(),this.emit(p.EventType.UIEvent.enter,c.GlobalEnum.UI.playerAssetBar),this.addGold(200,this.exit.bind(this)),this.bar.active=!1},e.prototype.exit=function(){this.emit(p.EventType.UIEvent.exit,c.GlobalEnum.UI.playerAssetBar),this.emit(p.EventType.UIEvent.exit,this.uiType),this.emit(p.EventType.UIEvent.touchBannerFinish)},e.prototype.addGold=function(t,e){var o=this;this.emit(p.EventType.AudioEvent.playEffect,c.GlobalEnum.AudioClip.gold);var n=this.goldLabel.convertToWorldSpaceAR(cc.v2()),i=cc.find("Canvas");n.x-=.5*i.width,n.y-=.5*i.height,this.emit(p.EventType.UIEvent.playGoldAnim,{startPos:n,cb:function(){o.emit(p.EventType.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t,mode:"+"}),e&&e()},gold:t})},e.prototype.update=function(t){this.updateProgress(t)},r([d(cc.Node)],e.prototype,"bar",void 0),r([d(cc.Node)],e.prototype,"box",void 0),r([d(cc.Node)],e.prototype,"player",void 0),r([d(cc.Node)],e.prototype,"goldLabel",void 0),r([l],e)}(h.default);o.default=y,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/GameFlow":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}]},{},["ChooseLevelUI","LvBox","ConfigSettingUI","GetPropUI","GoldDialogUI","ShopItem","ShopUI","TouchBannerUI1","TouchBannerUI2","TouchBannerUI3","TouchBannerUI4"]);